# 管理员系统使用指南

## 功能概述

"古月今语"对话系统创建了一个完整的管理员后台，包含以下功能模块：

### 1. 管理员登录验证
- **访问地址**: `/admin`
- **默认账号**: admin
- **默认密码**: admin123
- 安全验证机制，只有登录后才能访问管理功能

### 2. 系统统计与报告 📊
- **总体数据**: 用户数、对话数、消息数、今日新增
- **用户活跃度趋势图**: 最近7天的用户活跃情况
- **最受欢迎角色排行**: 各历史人物的对话次数统计

### 3. AI配置面板 ⚙️
- **模型选择**: 支持配置文本模型（Qwen Plus/Turbo/Max）和图像模型
- **响应阈值设定**: 配置响应时间阈值和内容安全等级
- **边界响应规则**: 设置AI的行为边界

### 4. 用户行为洞察 👥
- **活跃用户排行**: 显示消息数最多的用户
- **角色偏好分析**: 统计每个角色的受欢迎程度
- **用户画像标签**: 分析用户行为模式

### 5. 问题库与知识管理 💬
- **历史对话记录**: 分页显示所有用户对话
- **对话搜索功能**: 支持按关键词搜索对话内容
- **对话分类标记**: 便于管理和分析

### 6. AI性能监控 📈
- **响应成功率**: 过去7天的AI响应成功率统计
- **24小时消息分布**: 按小时统计的消息量图表
- **图片生成统计**: 图片请求和生成成功率

### 7. 内容安全与过滤 🛡️
- **敏感内容统计**: 今日、本周、总计拦截数量
- **过滤规则管理**: 政治敏感词、不当内容、垃圾信息过滤开关
- **内容审批机制**: 对敏感内容进行审核

## 技术实现

### 后端新增功能
1. **新增路由**:
   - `/admin` - 管理员登录页面
   - `/admin/login` - 处理登录验证
   - `/admin/dashboard` - 管理员仪表板
   - `/admin/logout` - 登出功能

2. **新增API接口**:
   - `/admin/api/stats` - 获取系统统计数据
   - `/admin/api/conversations` - 获取对话记录（分页）
   - `/admin/api/users` - 获取用户统计数据
   - `/admin/api/performance` - 获取AI性能数据

3. **数据库扩展**:
   - `get_admin_stats()` - 获取管理员统计数据
   - `get_all_conversations()` - 获取所有对话记录
   - `get_user_statistics()` - 获取用户统计数据
   - `get_performance_stats()` - 获取性能统计数据

### 前端特性
1. **响应式设计**: 使用 Tailwind CSS 实现美观的响应式界面
2. **数据可视化**: 集成 Chart.js 显示趋势图表
3. **实时数据**: AJAX 异步加载，提供流畅的用户体验
4. **安全验证**: Session 验证，防止未授权访问

## 使用方法

### 1. 启动系统
```bash
cd 项目名称
python3 start.py
```

### 2. 访问管理后台
1. 在浏览器中访问 `http://localhost:6888/admin`
2. 输入管理员账号密码（admin/admin123）
3. 登录后即可使用各项管理功能

### 3. 功能操作
- **切换模块**: 点击左侧导航菜单切换不同功能模块
- **查看数据**: 各模块会自动加载对应的统计数据
- **实时监控**: 数据会定期更新，显示最新状态

## 安全注意事项

1. **密码安全**: 建议在生产环境中修改默认管理员密码
2. **访问控制**: 确保管理员页面只对授权人员开放
3. **数据备份**: 定期备份数据库，防止数据丢失
4. **日志监控**: 关注系统日志，及时发现异常行为

## 自定义配置

### 修改管理员账号
在 `app.py` 的 `admin_login_post` 函数中修改：
```python
if username == 'your_admin' and password == 'your_password':
```

### 调整数据刷新频率
在 `admin_dashboard.html` 中修改定时器：
```javascript
setInterval(updateTime, 1000); // 修改更新间隔
```

### 添加新的统计指标
1. 在 `models.py` 中添加新的查询方法
2. 在 `app.py` 中添加对应的API接口
3. 在前端页面中添加显示逻辑

这个管理员系统提供了全面的数据监控和管理功能，帮助管理员更好地了解和管理"古月今语"对话系统的运行状况。